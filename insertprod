import pymysql
from PyQt5 import QtWidgets, QtGui, QtCore, uic
from PyQt5.QtWidgets import *
import sys


class Ui_AddProd(QDialog):

    def insert_prod(self):
        conn = pymysql.connect('localhost', 'den', 'den20', 'store')

        idproduct = self.idprod.text()
        product_name = self.Name.text()
        description = self.Descrip.text()
        price = self.Price.text()
        classification = self.Classi()
        quantity = self.qty()

        if (idproduct == '' or product_name == '' or description == '' or price == '' or classification == '' or quantity == ''):
            QMessageBox.about(self, 'Error', "Please input the following!")
            return

        with conn:
            cur = conn.cursor()
            qry = "SELECT * FROM product"
            cur.execute(qry)
            result = tuple(cur.fetchall())
            list_pro = {}

            for list_count in range(0, len(result)):
                list_pro[result[list_count][0]] = result[list_count]

            if (idproduct in list_pro):
                if(product_name == list_pro[idproduct][1] and description == list_pro[idproduct][2] and price == list_pro[idproduct][3], classification == list_pro[idproduct][4], quantity == list_pro[idproduct][5]):
                    QMessageBox.about(self, 'Warning', "Already exists")
                else:
                    QMessageBox.about(self, 'Warning', "Already exists")

            else:
                insert_qry = """INSERT INTO product (idproduct, product_name, description, price, classification, quantity) values (%s, %s, %s, %s, %s ,%s)""".format()
                cur.execute(insert_qry)
                QMessageBox.about(self, 'Insertion', "Added successfully")
                conn.commit()
        return

    def setupUi(self, idproduct):
        idproduct.setObjectName("idproduct")
        idproduct.resize(532, 534)
        idproduct.setMinimumSize(QtCore.QSize(200, 200))
        idproduct.setMaximumSize(QtCore.QSize(600, 600))
        font = QtGui.QFont()
        font.setFamily("Ubuntu")
        idproduct.setFont(font)
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap("../../.designer/backup/Resources/S.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        idproduct.setWindowIcon(icon)
        idproduct.setAutoFillBackground(False)
        idproduct.setStyleSheet("")
        idproduct.setSizeGripEnabled(False)
        self.label_8 = QtWidgets.QLabel(idproduct)
        self.label_8.setGeometry(QtCore.QRect(210, 40, 131, 31))
        font = QtGui.QFont()
        font.setFamily("FontAwesome")
        font.setPointSize(14)
        font.setBold(True)
        font.setUnderline(True)
        font.setWeight(75)
        font.setKerning(True)
        self.label_8.setFont(font)
        self.label_8.setAutoFillBackground(False)
        self.label_8.setObjectName("label_8")
        self.graphicsView = QtWidgets.QGraphicsView(idproduct)
        self.graphicsView.setGeometry(QtCore.QRect(-190, -160, 741, 721))
        self.graphicsView.setStyleSheet("background-image: url(:/Backgrounds/internal_medicine_zhanna_tsukerman.jpg);")
        self.graphicsView.setObjectName("graphicsView")
        self.verticalLayoutWidget = QtWidgets.QWidget(idproduct)
        self.verticalLayoutWidget.setGeometry(QtCore.QRect(40, 87, 160, 291))
        self.verticalLayoutWidget.setObjectName("verticalLayoutWidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.verticalLayoutWidget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.label_4 = QtWidgets.QLabel(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Sitka Heading")
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.label_4.setFont(font)
        self.label_4.setObjectName("label_4")
        self.verticalLayout.addWidget(self.label_4)
        self.label = QtWidgets.QLabel(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Sitka Heading")
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.label.setFont(font)
        self.label.setObjectName("label")
        self.verticalLayout.addWidget(self.label)
        self.label_3 = QtWidgets.QLabel(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Sitka Heading")
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.label_3.setFont(font)
        self.label_3.setObjectName("label_3")
        self.verticalLayout.addWidget(self.label_3)
        self.label_2 = QtWidgets.QLabel(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Sitka Heading")
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.label_2.setFont(font)
        self.label_2.setObjectName("label_2")
        self.verticalLayout.addWidget(self.label_2)
        self.label_5 = QtWidgets.QLabel(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Sitka Heading")
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.label_5.setFont(font)
        self.label_5.setObjectName("label_5")
        self.verticalLayout.addWidget(self.label_5)
        self.label_6 = QtWidgets.QLabel(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Sitka Heading")
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.label_6.setFont(font)
        self.label_6.setObjectName("label_6")
        self.verticalLayout.addWidget(self.label_6)
        self.horizontalLayoutWidget = QtWidgets.QWidget(idproduct)
        self.horizontalLayoutWidget.setGeometry(QtCore.QRect(299, 430, 201, 80))
        self.horizontalLayoutWidget.setObjectName("horizontalLayoutWidget")
        self.horizontalLayout = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget)
        self.horizontalLayout.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.AddMembah = QtWidgets.QPushButton(self.horizontalLayoutWidget)
        self.AddMembah.setObjectName("AddMembah")
        self.horizontalLayout.addWidget(self.AddMembah)
        self.cancel = QtWidgets.QPushButton(self.horizontalLayoutWidget)
        self.cancel.setObjectName("cancel")
        self.horizontalLayout.addWidget(self.cancel)
        self.verticalLayoutWidget_2 = QtWidgets.QWidget(idproduct)
        self.verticalLayoutWidget_2.setGeometry(QtCore.QRect(220, 80, 281, 311))
        self.verticalLayoutWidget_2.setObjectName("verticalLayoutWidget_2")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget_2)
        self.verticalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.idprod = QtWidgets.QLineEdit(self.verticalLayoutWidget_2)
        self.idprod.setStyleSheet("background-image: transparent;")
        self.idprod.setText("")
        self.idprod.setPlaceholderText("")
        self.idprod.setObjectName("idprod")
        self.verticalLayout_2.addWidget(self.idprod)
        self.Name = QtWidgets.QLineEdit(self.verticalLayoutWidget_2)
        self.Name.setStyleSheet("background-image: transparent;")
        self.Name.setText("")
        self.Name.setPlaceholderText("")
        self.Name.setObjectName("Name")
        self.verticalLayout_2.addWidget(self.Name)
        self.Classi = QtWidgets.QComboBox(self.verticalLayoutWidget_2)
        self.Classi.setObjectName("Classi")
        self.Classi.addItem("")
        self.Classi.addItem("")
        self.Classi.addItem("")
        self.verticalLayout_2.addWidget(self.Classi)
        self.Descrip = QtWidgets.QLineEdit(self.verticalLayoutWidget_2)
        self.Descrip.setObjectName("Descrip")
        self.verticalLayout_2.addWidget(self.Descrip)
        self.qty = QtWidgets.QSpinBox(self.verticalLayoutWidget_2)
        self.qty.setStyleSheet("background-image: transparent;")
        self.qty.setObjectName("qty")
        self.verticalLayout_2.addWidget(self.qty)
        self.Price = QtWidgets.QLineEdit(self.verticalLayoutWidget_2)
        self.Price.setObjectName("Price")
        self.verticalLayout_2.addWidget(self.Price)
        self.graphicsView.raise_()
        self.label_8.raise_()
        self.verticalLayoutWidget.raise_()
        self.horizontalLayoutWidget.raise_()
        self.verticalLayoutWidget_2.raise_()

        self.retranslateUi(idproduct)
        QtCore.QMetaObject.connectSlotsByName(idproduct)

    def retranslateUi(self, idproduct):
        _translate = QtCore.QCoreApplication.translate
        idproduct.setWindowTitle(_translate("idproduct", "Add Product"))
        self.label_8.setText(_translate("idproduct", "Add Product"))
        self.label_4.setText(_translate("idproduct", "Product ID:"))
        self.label.setText(_translate("idproduct", "Product name:"))
        self.label_3.setText(_translate("idproduct", "Classification"))
        self.label_2.setText(_translate("idproduct", "Description:"))
        self.label_5.setText(_translate("idproduct", "Quantity"))
        self.label_6.setText(_translate("idproduct", "Price"))
        self.AddMembah.setText(_translate("idproduct", "Add"))
        self.cancel.setText(_translate("idproduct", "Cancel"))
        self.Classi.setItemText(0, _translate("idproduct", "--"))
        self.Classi.setItemText(1, _translate("idproduct", "Branded"))
        self.Classi.setItemText(2, _translate("idproduct", "Generic"))


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    idproduct = QtWidgets.QDialog()
    ui = Ui_AddProd()
    ui.setupUi(idproduct)
    idproduct.show()
    sys.exit(app.exec_())